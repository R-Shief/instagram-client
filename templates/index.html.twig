{% extends "layout.html.twig" %}

{% block stylesheets %}
    <link href="{{ app.request_stack.getCurrentRequest.basePath }}/vendor/leaflet/dist/leaflet.css" rel="stylesheet">
    <link href="{{ app.request_stack.getCurrentRequest.basePath }}/vendor/leaflet.draw/dist/leaflet.draw.css" rel="stylesheet">
    <style>
        #map { height: 100vh; }
    </style>
{% endblock %}

{% block javascripts %}
    <script src="{{ app.request_stack.getCurrentRequest.basePath }}/vendor/leaflet/dist/leaflet.js"></script>
    <script src="{{ app.request_stack.getCurrentRequest.basePath }}/vendor/leaflet-providers/leaflet-providers.js"></script>
    <script src="{{ app.request_stack.getCurrentRequest.basePath }}/vendor/leaflet.draw/dist/leaflet.draw.js"></script>
    <script>
        var map = L.map('map').fitBounds([
                    [33.433380, 35.940941],
                    [29.496500, 34.267700]
                ]),
                drawnItems = new L.FeatureGroup();

        L.tileLayer('MapBox.bangpound.ij8i95a0').addTo(map);

        map.addLayer(drawnItems);

        var drawControl = new L.Control.Draw({
            draw: {
                position: 'topleft',
                polygon: false,
                polyline: false,
                marker: false,
                rectangle: false,
                circle: {
                }
            },
            edit: {
                featureGroup: drawnItems
            }
        });
        map.addControl(drawControl);

        map.on('draw:created', function (e) {
            var type = e.layerType,
                    layer = e.layer;

            var latLng = layer.getLatLng();
            var radius = layer.getRadius();

            $('#form_lat').val(latLng.lat);
            $('#form_lng').val(latLng.lng);
            $('#form_distance').val(radius);

            drawnItems.addLayer(layer);
        });


    </script>
{% endblock %}

{% block content %}
    {{ form(form) }}
    <div id="map"></div>
{% endblock %}
